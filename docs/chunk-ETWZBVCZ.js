import{a as T,c as N,d as k,e as b,f as v,h as V,i as A,j as O,m as G}from"./chunk-WEXOQBYC.js";import{g as L}from"./chunk-LRRIKLGP.js";import{$a as M,Ac as R,Eb as x,Fb as l,Gc as S,Hb as C,Mc as E,Nb as I,Va as n,Wa as _,_ as y,da as F,ia as P,jb as p,lb as a,pb as d,qb as m,ra as u,rb as f,sa as g,ub as h,wb as w,xb as c}from"./chunk-AVFOVZ2H.js";var j=(()=>{let o=class o{constructor(t){this._HttpClient=t,this.baseUl="https://ecommerce.routemisr.com/api/v1/auth/"}forgetPassword(t){return this._HttpClient.post(this.baseUl+"forgotPasswords",t)}verifyResetCode(t){return this._HttpClient.post(this.baseUl+"verifyResetCode",t)}resetPassword(t){return this._HttpClient.put(this.baseUl+"resetPassword",t)}};o.\u0275fac=function(s){return new(s||o)(F(E))},o.\u0275prov=y({token:o,factory:o.\u0275fac,providedIn:"root"});let e=o;return e})();function U(e,o){e&1&&f(0,"i",12)}function q(e,o){if(e&1&&(d(0,"p",13),l(1),m()),e&2){let r=c(2);n(),C(" ",r.userMsg," ")}}function z(e,o){if(e&1){let r=h();d(0,"section",5)(1,"form",6)(2,"label",7),l(3,"Email:"),m(),f(4,"input",8),d(5,"button",9,0),w("click",function(){u(r);let s=x(6),i=c();return g(i.forgotPassword(s))}),l(7," Forgot Password "),p(8,U,1,0,"i",10),m(),p(9,q,2,1,"p",11),m()()}if(e&2){let r=c();n(),a("formGroup",r.forgotForm),n(7),a("ngIf",r.isLoading),n(),a("ngIf",r.userMsg)}}function B(e,o){e&1&&f(0,"i",12)}function J(e,o){if(e&1&&(d(0,"p",13),l(1),m()),e&2){let r=c(2);n(),C(" ",r.userMsg," ")}}function K(e,o){if(e&1){let r=h();d(0,"section",14)(1,"form",6)(2,"label",15),l(3,"Reset Code:"),m(),f(4,"input",16),d(5,"button",9,1),w("click",function(){u(r);let s=x(6),i=c();return g(i.resetPasswordCode(s))}),l(7," Reset Code "),p(8,B,1,0,"i",10),m(),p(9,J,2,1,"p",11),m()()}if(e&2){let r=c();n(),a("formGroup",r.resetCode),n(7),a("ngIf",r.isLoading),n(),a("ngIf",r.userMsg)}}function Q(e,o){e&1&&f(0,"i",12)}function W(e,o){if(e&1&&(d(0,"p",13),l(1),m()),e&2){let r=c(2);n(),C(" ",r.userMsg," ")}}function X(e,o){if(e&1){let r=h();d(0,"section",14)(1,"form",6)(2,"label",17),l(3,"New Password:"),m(),f(4,"input",18),d(5,"button",9,2),w("click",function(){u(r);let s=x(6),i=c();return g(i.newPassword(s))}),l(7," Reset Password "),p(8,Q,1,0,"i",10),m(),p(9,W,2,1,"p",11),m()()}if(e&2){let r=c();n(),a("formGroup",r.resetPassword),n(7),a("ngIf",r.isLoading),n(),a("ngIf",r.userMsg)}}var oe=(()=>{let o=class o{constructor(t,s,i){this._ForgetpassService=t,this._Renderer2=s,this._Router=i,this.step1=!0,this.step2=!1,this.step3=!1,this.isLoading=!1,this.email="",this.userMsg="",this.forgotForm=new b({email:new v("")}),this.resetCode=new b({resetCode:new v("")}),this.resetPassword=new b({newPassword:new v("")})}forgotPassword(t){this.isLoading=!0,this._Renderer2.setAttribute(t,"disabled","true");let s=this.forgotForm.value;this.email=s.email,this._ForgetpassService.forgetPassword(s).subscribe({next:i=>{this.userMsg=i.message,this.isLoading=!1,this._Renderer2.setAttribute(t,"disabled","true"),this.step1=!1,this.step2=!0},error:i=>{this.userMsg=i.error.message,this.isLoading=!1,this._Renderer2.removeAttribute(t,"disabled")}})}resetPasswordCode(t){this._Renderer2.setAttribute(t,"disabled","true"),this.isLoading=!0;let s=this.resetCode.value;this._ForgetpassService.verifyResetCode(s).subscribe({next:i=>{this.step2=!1,this.step3=!0,this.userMsg=i.message,this._Renderer2.removeAttribute(t,"disabled"),this.isLoading=!1},error:i=>{this.userMsg=i.error.message,this._Renderer2.removeAttribute(t,"disabled"),this.isLoading=!1}})}newPassword(t){this._Renderer2.setAttribute(t,"disabled","true"),this.isLoading=!0;let s=this.resetPassword.value;s.email=this.email,this._ForgetpassService.resetPassword(s).subscribe({next:i=>{console.log(i),this._Renderer2.removeAttribute(t,"disabled"),this.isLoading=!1,this.isLoading=!1,i.token&&(localStorage.setItem("token",i.token),this._Router.navigate(["/home"]))},error:i=>{this.userMsg=i.error.message,this.isLoading=!1}})}};o.\u0275fac=function(s){return new(s||o)(_(j),_(M),_(L))},o.\u0275cmp=P({type:o,selectors:[["app-forgotpassword"]],standalone:!0,features:[I],decls:3,vars:3,consts:[["btnForget",""],["btnReset",""],["btnNew",""],["class","my-3 py-3 width mx-auto rounded bg-main-light p-3 shadow",4,"ngIf"],["class","width mx-auto rounded bg-main-light p-3 shadow",4,"ngIf"],[1,"my-3","py-3","width","mx-auto","rounded","bg-main-light","p-3","shadow"],[3,"formGroup"],["for","email"],["formControlName","email","type","email","id","email",1,"form-control","my-2"],[1,"main-btn","w-100","mt-3",3,"click"],["class","fas fa-spin fa-spinner",4,"ngIf"],["class","my-3 alert alert-danger mx-auto p-1 mb-0",4,"ngIf"],[1,"fas","fa-spin","fa-spinner"],[1,"my-3","alert","alert-danger","mx-auto","p-1","mb-0"],[1,"width","mx-auto","rounded","bg-main-light","p-3","shadow"],["for","resetCode"],["formControlName","resetCode","type","text","id","resetCode",1,"form-control","my-2"],["for","resetPassword"],["formControlName","newPassword","type","password","id","resetPassword",1,"form-control","my-2"]],template:function(s,i){s&1&&p(0,z,10,3,"section",3)(1,K,10,3,"section",4)(2,X,10,3,"section",4),s&2&&(a("ngIf",i.step1),n(),a("ngIf",i.step2),n(),a("ngIf",i.step3))},dependencies:[S,R,G,V,T,N,k,A,O],styles:["@media only screen and (max-width: 575px){.width[_ngcontent-%COMP%], .container[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%]{max-width:300px!important}}@media only screen and (min-width: 576px) and (max-width: 1400px){.width[_ngcontent-%COMP%], .container[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%]{max-width:400px!important}}"]});let e=o;return e})();export{oe as ForgotpasswordComponent};
