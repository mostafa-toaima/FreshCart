import{a as j}from"./chunk-RD2SM3GJ.js";import{a as N}from"./chunk-VMJZIDPE.js";import{a as O}from"./chunk-GKVWQC26.js";import{a as z}from"./chunk-GH4GP4SJ.js";import{a as D}from"./chunk-N3M6Y7YM.js";import"./chunk-WXI33M2S.js";import"./chunk-LRRIKLGP.js";import{a as B,b as $,c as M}from"./chunk-ZGVJUQJM.js";import{$a as T,Ac as A,Eb as b,Fb as g,Fc as E,Gb as x,Gc as R,Hb as y,Nb as F,Ob as k,Qa as I,Rb as V,Ub as C,Va as a,Wa as _,Wb as P,ia as w,jb as u,lb as d,nb as L,pb as s,qb as l,ra as m,rb as v,sa as p,ub as h,wb as f,xb as c,zc as W}from"./chunk-AVFOVZ2H.js";var G=(n,o,t)=>({id:"productPaginate",itemsPerPage:n,currentPage:o,totalItems:t}),H=()=>[1,2,3,4,5];function Y(n,o){if(n&1){let t=h();s(0,"i",20),f("click",function(){m(t);let e=c().$implicit,r=c(2);return p(r.addFav(e._id))}),l()}}function q(n,o){if(n&1){let t=h();s(0,"i",21),f("click",function(){m(t);let e=c().$implicit,r=c(2);return p(r.removeFav(e._id))}),l()}}function J(n,o){if(n&1&&v(0,"i",22),n&2){let t=o.$implicit,i=c().$implicit;L("rating-color",i.ratingsAverage>=t)}}function K(n,o){n&1&&v(0,"i",23)}function Q(n,o){if(n&1){let t=h();s(0,"div",7)(1,"div",8),u(2,Y,1,0,"i",9)(3,q,1,0,"i",10),s(4,"header"),v(5,"img",11),s(6,"h3",12),g(7),C(8,"cutText"),l(),s(9,"h4",13),g(10),l(),s(11,"div",14)(12,"span"),g(13),C(14,"currency"),l(),s(15,"p",15),u(16,J,1,2,"i",16),s(17,"span",17),g(18),l()()()(),s(19,"footer")(20,"button",18,0),f("click",function(){let e=m(t).$implicit,r=b(21),S=c(2);return p(S.addToCart(e._id,r))}),g(22," + Add To Cart "),u(23,K,1,0,"i",19),l()()()()}if(n&2){let t=o.$implicit,i=b(21),e=c(2);a(2),d("ngIf",!e.wishListData.includes(t._id)),a(),d("ngIf",e.wishListData.includes(t._id)),a(2),d("src",t==null?null:t.imageCover,I)("title",t==null?null:t.title)("alt",t==null?null:t.title),a(2),x(P(8,11,t.title,2)),a(3),x(t==null||t.category==null?null:t.category.name),a(3),y(" ",P(14,14,t.price,"EGP ")," "),a(3),d("ngForOf",k(17,H)),a(2),x(t.ratingsAverage),a(5),d("ngIf",i.disabled)}}function X(n,o){if(n&1){let t=h();s(0,"section",2)(1,"div",3),u(2,Q,24,18,"div",4),C(3,"paginate"),l(),s(4,"div",5)(5,"pagination-controls",6),f("pageChange",function(e){m(t);let r=c();return p(r.pageChanged(e))})("pageBoundsCorrection",function(e){m(t);let r=c();return p(r.pageChanged(e))}),l()()()}if(n&2){let t=c();a(2),d("ngForOf",P(3,5,t.products,V(8,G,t.pageSize,t.currentPage,t.total))),a(3),d("maxSize",9)("directionLinks",!0)("autoHide",!0)("responsive",!0)}}var le=(()=>{let o=class o{constructor(i,e,r,S,U){this._ProductsService=i,this._Render2=e,this._TostarService=r,this._CartService=S,this._WishlistService=U,this.products=[],this.pageSize=0,this.currentPage=1,this.total=0,this.isLoading=!1,this.wishListData=[]}ngOnInit(){this.getProducts(this.currentPage),this.getWishListUser()}getWishListUser(){this._WishlistService.getLoggedUserWishlist().subscribe({next:i=>{console.log(i),this.wishListData=i.data.map(e=>e._id)}})}getProducts(i){this._ProductsService.GetAllProducts(i).subscribe({next:e=>{console.log("products ",e),this.products=e.data,this.pageSize=e.metadata.limit,this.currentPage=e.metadata.currentPage,this.total=e.results},error:e=>{console.log(e)}})}pageChanged(i){console.log(i),this.currentPage=i,this.getProducts(i)}addToCart(i,e){this._Render2.setAttribute(e,"disabled","true"),this.isLoading=!0,this._CartService.addToCart(i).subscribe({next:r=>{console.log(r),this.isLoading=!1,this._TostarService.success(r.message),this._Render2.removeAttribute(e,"disabled"),this._CartService.cartNumber.next(r.numOfCartItems)},error:r=>{console.log(r),this._TostarService.error(r.message),this.isLoading=!1,this._Render2.removeAttribute(e,"disabled")}})}addFav(i){this._WishlistService.addItemToWishList(i).subscribe({next:e=>{console.log(e),this._TostarService.success(e.message),this.wishListData=e.data,this._WishlistService.whishItemNumber.next(e.data.length)},error:e=>{console.log(e)}})}removeFav(i){this._WishlistService.removeItemFromWishList(i).subscribe({next:e=>{this._TostarService.success(e.message),this.wishListData=e.data,this._WishlistService.whishItemNumber.next(e.data.length)},error:e=>{}})}};o.\u0275fac=function(e){return new(e||o)(_(O),_(T),_(z),_(D),_(j))},o.\u0275cmp=w({type:o,selectors:[["app-products"]],standalone:!0,features:[F],decls:1,vars:1,consts:[["btnAdd",""],["class","py-4",4,"ngIf"],[1,"py-4"],[1,"row","justify-content-center","g-4"],["class","col-sm-6 col-md-4 col-lg-3 col-xl-2",4,"ngFor","ngForOf"],[1,"pt-4","text-main","text-center"],["id","productPaginate","previousLabel","Previous","nextLabel","Next","screenReaderPaginationLabel","Pagination","screenReaderPageLabel","page","screenReaderCurrentLabel","You're on page",3,"pageChange","pageBoundsCorrection","maxSize","directionLinks","autoHide","responsive"],[1,"col-sm-6","col-md-4","col-lg-3","col-xl-2"],[1,"product","h-100","px-2","py-2"],["class","fa-regular text-danger fa-heart heart",3,"click",4,"ngIf"],["class","fa-solid text-danger fa-heart heart",3,"click",4,"ngIf"],[1,"w-100",3,"src","title","alt"],[1,"h6"],[1,"h6","text-main"],[1,"d-flex","align-items-center","justify-content-between","small"],[1,"mb-0"],["class","fas fa-star font-sm",3,"rating-color",4,"ngFor","ngForOf"],[1,"text-muted"],[1,"btn","main-btn","w-100","my-2",3,"click"],["class","fas fa-spin fa-spinner",4,"ngIf"],[1,"fa-regular","text-danger","fa-heart","heart",3,"click"],[1,"fa-solid","text-danger","fa-heart","heart",3,"click"],[1,"fas","fa-star","font-sm"],[1,"fas","fa-spin","fa-spinner"]],template:function(e,r){e&1&&u(0,X,6,12,"section",1),e&2&&d("ngIf",r.products.length>0)},dependencies:[R,W,A,E,N,M,B,$]});let n=o;return n})();export{le as ProductsComponent};
